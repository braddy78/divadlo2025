<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Braddyovic Divadeln√≠ Sez√≥na 2025 (Fixed Dark Mode)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #09090b;
            --card-bg: #131318;
            --input-bg: #1f1f26;
            --text-main: #e4e4e7;
            --accent-pink: #f43f5e;
            --accent-cyan: #06b6d4;
            --accent-yellow: #f59e0b;
            --accent-purple: #8b5cf6;
            --border-color: #27272a;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            padding-bottom: 80px;
        }

        h1, h2, h3, h4 { font-weight: 800; text-transform: uppercase; letter-spacing: 0.5px; }

        /* Header */
        .header-section {
            background: radial-gradient(circle at top, #1e1b4b 0%, #09090b 100%);
            padding: 40px 0;
            border-bottom: 3px solid var(--accent-cyan);
            box-shadow: 0 0 50px rgba(6, 182, 212, 0.2);
            margin-bottom: 30px;
        }

        .glitch-text {
            font-size: 2.5rem;
            color: white;
            text-shadow: 2px 2px 0px var(--accent-purple);
        }

        /* Stats Cards */
        .stats-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        .stats-card:hover { 
            transform: translateY(-5px); 
            border-color: var(--accent-pink);
            box-shadow: 0 10px 25px rgba(244, 63, 94, 0.1);
        }
        .stats-number {
            font-size: 2.8rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .stats-label { font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1.5px; opacity: 0.9; font-weight: 600; }

        /* Charts */
        .chart-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .chart-title { color: var(--accent-yellow); font-size: 1rem; margin-bottom: 15px; border-left: 3px solid var(--accent-pink); padding-left: 10px; }

        /* Filters */
        .filter-bar {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px 12px 0 0;
            padding: 15px;
            margin-bottom: 0;
        }
        .form-control, .form-select {
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: white;
            font-size: 0.9rem;
        }
        .form-control:focus, .form-select:focus {
            background-color: #272730;
            color: white;
            border-color: var(--accent-cyan);
            box-shadow: none;
        }

        /* TABLE FIXES - AGGRESSIVE DARK MODE */
        .table-container {
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 12px 12px;
            overflow: hidden;
            background-color: var(--card-bg);
        }
        
        .table-scroll {
            overflow-y: auto;
            max-height: 600px;
        }

        /* Force override Bootstrap variables for tables */
        .table {
            --bs-table-bg: var(--card-bg);
            --bs-table-color: var(--text-main);
            --bs-table-hover-bg: #27272a;
            --bs-table-hover-color: white;
            margin-bottom: 0;
            background-color: var(--card-bg);
            color: var(--text-main);
        }

        /* Direct targeting of elements to ensure black background */
        .table th, .table td {
            background-color: var(--card-bg) !important;
            color: var(--text-main) !important;
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
        }

        /* Header styling */
        .table thead th {
            background-color: #000000 !important; /* Total black header */
            color: var(--accent-cyan) !important;
            border-bottom: 2px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        /* Hover effect - must use !important to override the direct targeting above */
        .table tbody tr:hover td {
            background-color: #1f1f26 !important; /* Slightly lighter black */
            color: white !important;
            cursor: pointer;
        }

        /* Badges */
        .badge-genre { background: rgba(139, 92, 246, 0.15); color: #a78bfa; border: 1px solid rgba(139, 92, 246, 0.3); }
        .badge-city { background: rgba(245, 158, 11, 0.15); color: #fbbf24; border: 1px solid rgba(245, 158, 11, 0.3); }
        
        /* Cancelled row styling */
        .cancelled-row td { 
            text-decoration: line-through; 
            opacity: 0.6; 
            color: #f43f5e !important; 
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent-cyan); }
    </style>
</head>
<body>

<div class="header-section text-center">
    <div class="container">
        <h1 class="glitch-text">Braddyovic Divadeln√≠ Sez√≥na 2025</h1>
        <p class="lead text-muted mt-2" style="color: var(--accent-cyan) !important;">
            Dramaturgick√Ω profil 2025: Audit odehran√Ωch titul≈Ø, soubor≈Ø a region√°ln√≠ch v√Ωjezd≈Ø.
        </p>
    </div>
</div>

<div class="container">
    
    <div class="row mb-4 g-3">
        <div class="col-6 col-md-3">
            <div class="stats-card">
                <div class="stats-number" id="statTotal">0</div>
                <div class="stats-label">üé´ Celkov√Ω poƒçet zhl√©dnut√≠</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stats-card">
                <div class="stats-number" id="statTheatres">0</div>
                <div class="stats-label">üé≠ Unik√°tn√≠ch soubor≈Ø</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stats-card">
                <div class="stats-number" id="statCities">0</div>
                <div class="stats-label">üó∫Ô∏è Nav≈°t√≠ven√Ωch mƒõst</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stats-card">
                <div class="stats-number" id="statRepeats">0</div>
                <div class="stats-label">üîÑ Guilty Pleasures (N√°vraty)</div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="chart-card">
                <h5 class="chart-title">üìà EKG Sez√≥ny (Mƒõs√≠ƒçn√≠ aktivita)</h5>
                <div style="height: 250px;"><canvas id="chartMonthly"></canvas></div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="chart-card">
                <h5 class="chart-title">üìç Geografie: Praha vs. Regiony</h5>
                <div style="height: 250px;"><canvas id="chartLocation"></canvas></div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-4">
            <div class="chart-card">
                <h5 class="chart-title">üèÜ Top 5 Soubor≈Ø</h5>
                <div style="height: 200px;"><canvas id="chartTheatres"></canvas></div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="chart-card">
                <h5 class="chart-title">üé≠ ≈Ω√°nrov√Ω Mix</h5>
                <div style="height: 200px;"><canvas id="chartGenres"></canvas></div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="chart-card">
                <h5 class="chart-title">üìÖ Dny v t√Ωdnu</h5>
                <div style="height: 200px;"><canvas id="chartDays"></canvas></div>
            </div>
        </div>
    </div>

    <div class="row" id="dataSection">
        <div class="col-12">
            <div class="filter-bar">
                <div class="row g-2 align-items-end">
                    <div class="col-md-3">
                        <label class="form-label text-white-50">üîç Hledat n√°zev</label>
                        <input type="text" id="filterTitle" class="form-control" placeholder="Nap≈ô. Peer Gynt...">
                    </div>
                    <div class="col-md-2">
                        <label class="form-label text-white-50">üé≠ Soubor</label>
                        <select id="filterTheatre" class="form-select"><option value="">V≈°e</option></select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label text-white-50">üìç Mƒõsto/M√≠sto</label>
                        <select id="filterCity" class="form-select"><option value="">V≈°e</option></select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label text-white-50">üß† ≈Ω√°nr</label>
                        <select id="filterGenre" class="form-select"><option value="">V≈°e</option></select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label text-white-50">üìÖ Mƒõs√≠c</label>
                        <select id="filterMonth" class="form-select">
                            <option value="">V≈°e</option>
                            <option value="0">Leden</option><option value="1">√önor</option>
                            <option value="2">B≈ôezen</option><option value="3">Duben</option>
                            <option value="4">Kvƒõten</option><option value="5">ƒåerven</option>
                            <option value="6">ƒåervenec</option><option value="7">Srpen</option>
                            <option value="8">Z√°≈ô√≠</option><option value="9">≈ò√≠jen</option>
                            <option value="10">Listopad</option><option value="11">Prosinec</option>
                        </select>
                    </div>
                    <div class="col-md-1">
                        <button class="btn btn-outline-info w-100" onclick="resetFilters()">Reset</button>
                    </div>
                </div>
            </div>
            
            <div class="table-container">
                <div class="table-scroll">
                    <table class="table table-dark table-hover mb-0">
                        <thead>
                            <tr>
                                <th style="width: 100px;">Datum</th>
                                <th>N√°zev p≈ôedstaven√≠</th>
                                <th>Soubor</th>
                                <th>M√≠sto / Divadlo</th>
                                <th>Mƒõsto</th>
                                <th>≈Ω√°nr</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            </tbody>
                    </table>
                </div>
                <div class="p-2 text-center text-muted small border-top border-secondary bg-dark">
                    Zobrazeno <span id="visibleCount">0</span> z√°znam≈Ø
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    /* --- 1. DATASET --- */
    
    const rawData = [
        // LEDEN
        ["03.01.2025", "Obraz", "Komorn√≠ sc√©na Ar√©na", "Komorn√≠ sc√©na Ar√©na", "Ostrava", "ƒåinohra"],
        ["04.01.2025", "Pravidla binc√°rny", "Husa na prov√°zku", "Husa na prov√°zku", "Brno", "ƒåinohra"],
        ["07.01.2025", "Celou noc venku", "Divadlo v Celetn√©", "Celetn√©", "", "ƒåinohra"],
        ["08.01.2025", "Na≈°i furianti", "N√°rodn√≠ divadlo", "N√°rodn√≠ divadlo", "", "ƒåinohra"],
        ["09.01.2025", "Koza aneb Kdo je Sylvie?", "Divadlo Bez z√°bradl√≠", "Divadlo Bez z√°bradl√≠", "", "ƒåinohra"],
        ["11.01.2025", "Pan√≠ Bovaryov√°", "N√°rodn√≠ divadlo", "Stavovsk√© divadlo", "", "ƒåinohra"],
        ["18.01.2025", "Tr√≥janky", "≈†vandovo divadlo", "≈†vandovo divadlo", "", "ƒåinohra"],
        ["19.01.2025", "Frankenstein", "Mƒõstsk√° divadla pra≈æsk√°", "Divadlo Komedie", "", "ƒåinohra"],
        ["20.01.2025", "Karameloun", "Ductus Deferens", "Pe≈°kovka", "", "Alternativa"],
        ["22.01.2025", "N√°vrat kr√°le", "≈†vandovo divadlo", "≈†vandovo divadlo", "", "ƒåinohra"],
        ["23.01.2025", "D√°nsk√° d√≠vka", "Divadlo Na Fidlovaƒçce", "Divadlo Na Fidlovaƒçce", "", "ƒåinohra"],
        ["26.01.2025", "Mefisto", "N√°rodn√≠ divadlo", "St√°tn√≠ opera", "", "ƒåinohra"],
        ["27.01.2025", "Norway Today", "Divadlo DISK", "Studio ≈òet√≠zek", "", "ƒåinohra"],
        ["27.01.2025", "Bible 2", "Divadlo NoD", "Divadlo NoD", "", "Alternativa"],
        ["28.01.2025", "Lh√°≈ôky", "Divadlo Let√≠", "Vila ≈†tvanice", "", "ƒåinohra"],
        ["29.01.2025", "Je≈æek", "Mƒõstsk√° divadla pra≈æsk√°", "Divadlo ABC", "", "Muzik√°l"],
        ["30.01.2025", "Privatizace", "N√°rodn√≠ divadlo", "Nov√° sc√©na", "", "ƒåinohra"],
        ["31.01.2025", "Peer Gynt", "Divadlo DISK", "Divadlo DISK", "", "ƒåinohra"],

        // √öNOR
        ["01.02.2025", "Chytte Chaplina!", "V√Ωchodoƒçesk√© divadlo Pardubice", "Mƒõstsk√© divadlo", "Pardubice", "ƒåinohra"],
        ["04.02.2025", "Na smrt", "Divadlo D21", "Divadlo D21", "", "ƒåinohra"],
        ["07.02.2025", "Podoba vƒõc√≠", "Klicperovo divadlo", "Divadlo v Dlouh√© (host)", "", "ƒåinohra"],
        ["11.02.2025", "Yvonna princezna Burgund√°nsk√°", "Festival NADAMU", "Studio ≈òet√≠zek", "", "Studentsk√©"],
        ["11.02.2025", "Karameloun", "Ductus Deferens", "Divadlo DISK (NADAMU)", "", "Studentsk√©"],
        ["12.02.2025", "Vƒõ≈°tkynƒõ", "Divadlo Na Fidlovaƒçce", "Divadlo Na Fidlovaƒçce", "", "ƒåinohra"],
        ["13.02.2025", "Iluze", "Festival NADAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["14.02.2025", "Noc Trib√°dek", "Festival NADAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["19.02.2025", "Tul√°k po hvƒõzd√°ch", "Divadeln√≠ spolek ≈†prajc", "Divadlo v Celetn√©", "", "ƒåinohra"],
        ["20.02.2025", "≈Ωeny dr≈æte huby!", "Spolek JEDL", "Divadlo Rokoko", "", "ƒåinohra"],
        ["23.02.2025", "V√°≈àa", "Didi.art", "Divadlo v ≈òeznick√©", "", "ƒåinohra"],
        ["24.02.2025", "N√°vrat kr√°le", "≈†vandovo divadlo", "≈†vandovo divadlo", "", "ƒåinohra"],
        ["26.02.2025", "N√°rodn√≠ t≈ô√≠da", "Neurƒçeno", "Pe≈°kovka", "", "ƒåinohra"],
        ["28.02.2025", "Doba datov√°", "Divadlo Degustace", "Studio Citadela", "", "Amat√©rsk√©"],

        // B≈òEZEN
        ["01.03.2025", "Pan√≠ Dallowayov√°", "Divadlo Na z√°bradl√≠", "Divadlo Na z√°bradl√≠", "", "ƒåinohra"],
        ["02.03.2025", "Zadn√≠m vchodem na Hrad", "DAMU", "Divadlo DISK", "", "Alternativa"],
        ["03.03.2025", "Peer Gynt", "DAMU", "Divadlo DISK", "", "ƒåinohra"],
        ["04.03.2025", "N√°vrat Kr√°le ≈†umavy", "Jihoƒçesk√© divadlo", "Jihoƒçesk√© divadlo", "ƒåesk√© Budƒõjovice", "ƒåinohra"],
        ["06.03.2025", "Sluƒçiteln√© d√≠ly", "Klicperovo divadlo", "Studio Beseda", "Hradec Kr√°lov√©", "ƒåinohra"],
        ["09.03.2025", "Historky z Tinderu 2", "LiStOV√°N√≠", "Divadlo Minor", "", "Alternativa"],
        ["12.03.2025", "27 litr≈Ø umƒõl√Ω krve", "Divadlo NoD", "Divadlo NoD", "", "Alternativa"],
        ["13.03.2025", "Manhattan Project", "Jihoƒçesk√© divadlo", "Jihoƒçesk√© divadlo", "ƒåesk√© Budƒõjovice", "ƒåinohra"],
        ["14.03.2025", "Na≈°i fabulanti", "Ductus Deferens", "Pe≈°kovka", "", "Alternativa"],
        ["15.03.2025", "Vra≈æda v ulici Lourcine", "DAMU", "Studio ≈òet√≠zek", "", "Studentsk√©"],
        ["16.03.2025", "GUƒåI GUƒåI GUƒåI", "DAMU", "Divadlo DISK", "", "Alternativa"],
        ["17.03.2025", "Noc trib√°dek", "HaDivadlo", "Divadlo ARCHA+ (host)", "", "ƒåinohra"],
        ["20.03.2025", "Pygmalion", "Divadlo pod Palmovkou", "Divadlo pod Palmovkou", "", "ƒåinohra"],
        ["23.03.2025", "LK3P 2: Zelenav√Ω pt√°ƒçek", "Divadlo VILA ≈†tvanice", "Divadlo VILA ≈†tvanice", "", "Barokn√≠"],
        ["24.03.2025", "Utƒõ≈°itelka", "Spolek JEDL", "Pe≈°kovka", "", "ƒåinohra"],
        ["25.03.2025", "Fakani", "A studio Rub√≠n", "A studio Rub√≠n", "", "ƒåinohra"],
        ["29.03.2025", "Krakatit", "Vr≈°ovick√© divadlo MANA", "Vr≈°ovick√© divadlo MANA", "", "ƒåinohra"],
        ["29.03.2025", "Noc Trib√°dek", "DAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["30.03.2025", "Z pohlavn√≠ho ≈æivota na≈°eho lidu", "Husa na prov√°zku", "Divadlo ARCHA+ (host)", "", "ƒåinohra"],
        ["31.03.2025", "Jednou n√°m za to dƒõcka podƒõkujou", "Husa na prov√°zku", "Divadlo ARCHA+ (host)", "", "ƒåinohra"],

        // DUBEN
        ["02.04.2025", "Atomov√° koƒçiƒçka", "V√Ωchodoƒçesk√© divadlo Pardubice", "Divadlo pod Palmovkou (host)", "", "ƒåinohra"],
        ["06.04.2025", "Na tom nez√°le≈æ√≠", "DAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["07.04.2025", "P≈ô√≠li≈° kr√°tk√° telomera", "Divadlo pod Palmovkou", "Studio PalmOFF", "", "ƒåinohra"],
        ["08.04.2025", "Pƒõna dn√≠", "Divadlo D21", "Divadlo D21", "", "ƒåinohra"],
        ["10.04.2025", "O poledn√°ch", "Depresivn√≠ dƒõti tou≈æ√≠ po penƒõz√≠ch", "Venu≈°e ve ≈†vehlovce", "", "Alternativa"],
        ["13.04.2025", "Kurt a Sid", "Malostransk√° beseda", "Malostransk√° beseda", "", "ƒåinohra"],
        ["14.04.2025", "VOJCEK jednorozmƒõrn√Ω ƒçlovƒõk", "Lachende Bestien", "Divadlo X10", "", "Alternativa"],
        ["17.04.2025", "Hamlet", "Jihoƒçesk√© divadlo", "Na P≈Ødƒõ", "ƒåesk√© Budƒõjovice", "ƒåinohra"],
        ["22.04.2025", "Podivuhodn√Ω p≈ô√≠pad Benjamina Buttona", "Mƒõstsk√° divadla pra≈æsk√°", "Divadlo Rokoko", "", "Muzik√°l"],

        // KVƒöTEN
        ["11.05.2025", "Tv√°≈ô v ohni", "Divadlo Na z√°bradl√≠", "Divadlo Na z√°bradl√≠", "", "ƒåinohra"],
        ["12.05.2025", "J√≠dlo", "Divadlo Debut", "Divadlo Debut", "", "ƒåinohra"],
        ["15.05.2025", "Divok√° kachna", "≈†vandovo divadlo", "≈†vandovo divadlo", "", "ƒåinohra"],
        ["15.05.2025", "Smiley", "Studio DVA divadlo", "Studio DVA (Mal√° sc√©na)", "", "ƒåinohra"],
        ["19.05.2025", "Vernis√°≈æ", "Divadlo D21", "Divadlo D21", "", "ƒåinohra"],
        ["23.05.2025", "Princess of the mlejn", "Ductus Deferens", "Pe≈°kovka", "", "Alternativa"],
        ["29.05.2025", "Ropa", "DAMU", "Divadlo DISK", "", "Studentsk√©"],

        // ƒåERVEN
        ["01.06.2025", "Na≈°i fabulanti", "Ductus Deferens", "Pe≈°kovka", "", "Alternativa"],
        ["05.06.2025", "Peer Gynt", "DAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["07.06.2025", "Komuna", "ƒåinohern√≠ klub", "ƒåinohern√≠ klub", "", "ƒåinohra"],
        ["09.06.2025", "R.U.R.", "DAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["10.06.2025", "How to be HAPPY", "DAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["12.06.2025", "OnlyFans", "Mƒõstsk√° divadla pra≈æsk√°", "Divadlo Komedie", "", "ƒåinohra"],
        ["15.06.2025", "Heda Gablerov√° - naostro", "ƒåinohern√≠ klub", "ƒåinohern√≠ klub", "", "ƒåinohra"],
        ["18.06.2025", "N√°vrat kr√°le", "≈†vandovo divadlo", "≈†vandovo divadlo", "", "ƒåinohra"],
        ["19.06.2025", "Babyboom", "ƒåinohern√≠ klub", "ƒåinohern√≠ klub", "", "ƒåinohra"],
        ["21.06.2025", "Nebesa", "Mƒõstsk√° divadla pra≈æsk√°", "Divadlo ABC", "", "ƒåinohra"],
        ["22.06.2025", "Projekt Casanova: Jak von√≠ Ramlice", "Geisslers Hofcomoedianten", "Z√°mek Valeƒç", "Valeƒç", "Barokn√≠"],
        ["23.06.2025", "Karameloun", "Ductus Deferens", "Lodivadlo", "Hradec Kr√°lov√©", "Alternativa"],
        ["23.06.2025", "Sluƒçiteln√© d√≠ly", "Klicperovo divadlo", "Letn√≠ kino ≈†ir√°k", "Hradec Kr√°lov√©", "ƒåinohra"],
        ["25.06.2025", "Ema", "Pe≈°kovka", "Pe≈°kovka", "", "Studentsk√©"],
        ["27.06.2025", "Pozdƒõ p≈ô√≠choz√≠", "Divadlo Petra Bezruƒçe", "Divadlo Archa (host)", "", "ƒåinohra"],
        ["28.06.2025", "Krysa≈ô", "Divadlo Petra Bezruƒçe", "Divadlo Archa (host)", "", "ƒåinohra"],

        // ƒåERVENEC
        ["14.07.2025", "Amat√©≈ôi", "Studio DVA divadlo", "Letn√≠ sc√©na V√Ωstavi≈°tƒõ", "", "ƒåinohra"],
        ["19.07.2025", "Herkules", "Jihoƒçesk√© divadlo", "Ot√°ƒçiv√© hledi≈°tƒõ", "ƒåesk√Ω Krumlov", "ƒåinohra"],
        ["24.07.2025", "Dr√Ωm D≈æurny", "Ductus Deferens", "Usedlost Cibulka", "", "Alternativa"],

        // SRPEN
        ["12.08.2025", "Buly divadlo ≈æivƒõ", "Buly divadlo", "Z√°mek Brand√Ωs", "Brand√Ωs n/L", "Alternativa"],
        ["20.08.2025", "Projekt Casanova: Jak von√≠ Ramlice", "Geisslers Hofcomoedianten", "Theatrum Kuks", "Kuks", "Barokn√≠"],
        ["21.08.2025", "Rezav√° Anna", "Geisslers Hofcomoedianten", "Theatrum Kuks", "Kuks", "Barokn√≠"],
        ["21.08.2025", "Casanova", "Spolek Jedl", "Theatrum Kuks", "Kuks", "ƒåinohra"],
        ["22.08.2025", "Pelech", "TMEL", "Theatrum Kuks", "Kuks", "Alternativa"],
        ["22.08.2025", "Dvƒõ komedie v komedii", "Geisslers Hofcomoedianten", "Theatrum Kuks", "Kuks", "Barokn√≠"],
        ["23.08.2025", "Puld a pudr", "Geisslers Hofcomoedianten", "Theatrum Kuks", "Kuks", "Barokn√≠"],
        ["25.08.2025", "≈Ωivot Galileiho", "Divadlo X10", "Divadlo X10", "", "ƒåinohra"],
        ["26.08.2025", "D≈Øm v jablon√≠ch", "Pomez√≠", "Winternitzova vila", "", "Imersivn√≠"],
        ["31.08.2025", "Herkules", "Jihoƒçesk√© divadlo", "Ot√°ƒçiv√© hledi≈°tƒõ", "ƒåesk√Ω Krumlov", "ƒåinohra"],
        ["31.08.2025", "Dekameron", "Jihoƒçesk√© divadlo", "Ot√°ƒçiv√© hledi≈°tƒõ", "ƒåesk√Ω Krumlov", "ƒåinohra"],

        // Z√Å≈ò√ç
        ["01.09.2025", "Dvoj√≠ z√°kon", "Krajinou p≈ô√≠livu", "Nov√° libe≈àsk√° synagoga", "", "ƒåinohra"],
        ["07.09.2025", "Huberte!", "Geisslers Hofcomoedianten", "Chvalsk√° tvrz", "", "Barokn√≠/Dƒõtsk√©"],
        ["09.09.2025", "Tragick√° historie Jana Fausta", "Divadlo K√°men", "Divadlo K√°men", "", "Alternativa"],
        ["22.09.2025", "Emil ƒçili O H√°chovi", "Divadlo D21", "Divadlo D21", "", "ƒåinohra"],
        ["25.09.2025", "Fu≈°e≈ôi", "Divadlo Na z√°bradl√≠", "Divadlo Na z√°bradl√≠", "", "ƒåinohra"],
        ["27.09.2025", "Vyhubyt", "Klicperovo divadlo", "Studio Beseda", "Hradec Kr√°lov√©", "ƒåinohra"],
        ["29.09.2025", "Krkavci", "Dejvick√© divadlo", "Dejvick√© divadlo", "", "ƒåinohra"],

        // ≈ò√çJEN
        ["01.10.2025", "O≈°klivec", "DAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["02.10.2025", "Princess of the mlejn", "Ductus Deferens", "Pe≈°kovka", "", "Alternativa"],
        ["03.10.2025", "Krysy", "DAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["06.10.2025", "Zloƒçin a trest", "Divadlo D21", "Divadlo D21", "", "ƒåinohra"],
        ["10.10.2025", "B≈Øh masakru", "Komorn√≠ sc√©na Ar√©na", "Klicperovo divadlo (host)", "Hradec Kr√°lov√©", "ƒåinohra"],
        ["11.10.2025", "ƒåek√°n√≠ na V√°clava", "Klicperovo divadlo", "Hlavn√≠ sc√©na", "Hradec Kr√°lov√©", "ƒåinohra"],
        ["11.10.2025", "Pra≈°ina 2", "Klicperovo divadlo", "Hlavn√≠ sc√©na", "Hradec Kr√°lov√©", "ƒåinohra"],
        ["12.10.2025", "Triomphez", "Vesel√© Chv√≠le", "Z√°mek Troja", "", "Hudebn√≠"],
        ["13.10.2025", "Wandervogel", "Alfred ve dvo≈ôe", "Alfred ve dvo≈ôe", "", "Alternativa"],
        ["15.10.2025", "Na≈°i Fabulanti", "Ductus Deferens", "Pe≈°kovka", "", "Alternativa"],
        ["18.10.2025", "Farinelli a kr√°l", "Mƒõstsk√° divadla pra≈æsk√°", "Divadlo Rokoko", "", "ƒåinohra"],
        ["22.10.2025", "Noƒçn√≠ m≈Øry s ƒç√°pem marabu", "MeetFactory", "MeetFactory", "", "Alternativa"],
        ["23.10.2025", "T√© tmƒõ ut√≠k√°m ve Smeƒçk√°ch", "ƒåinohern√≠ klub", "Site specific", "", "Site specific"],
        ["26.10.2025", "Arabsk√° noc", "Divadlo Na z√°bradl√≠", "Divadlo Na z√°bradl√≠", "", "ƒåinohra"],
        ["27.10.2025", "Kdo je tady praporƒç√≠k?", "Ductus Deferens", "Divadlo v Celetn√©", "", "Studentsk√©"],
        ["29.10.2025", "Jezinky a bezinky", "Studio DVA divadlo", "Studio DVA divadlo", "", "ƒåinohra"],
        ["30.10.2025", "Miluj mrtv√©ho sv√©ho", "Divadlo Debut", "Divadlo Debut", "", "ƒåinohra"],
        ["31.10.2025", "Hnƒõv", "Geisslers Hofcomoedianten", "Divadlo VILA ≈†tvanice", "", "Alternativa"],
        ["31.10.2025", "P√≠skovi≈°tƒõ", "OLDstars", "Dejvick√© divadlo", "", "Studentsk√©"],

        // LISTOPAD
        ["01.11.2025", "Fernando Krapp mi napsal dopis", "ƒåinohern√≠ klub", "ƒåinohern√≠ klub", "", "ƒåinohra"],
        ["03.11.2025", "Tartuffl√°≈æ", "Divadlo D21", "Divadlo D21", "", "ƒåinohra"],
        ["05.11.2025", "Kr√°sn√Ω nov√Ω den", "Pomez√≠", "Za Po≈ô√≠ƒçskou br√°nou", "", "Imersivn√≠"],
        ["06.11.2025", "Monstrum", "Jihoƒçesk√© divadlo", "Na P≈Ødƒõ", "ƒåesk√© Budƒõjovice", "ƒåinohra"],
        ["10.11.2025", "Smrd√≠≈° ty!", "Ductus Deferens", "Pe≈°kovka", "", "Alternativa"],
        ["12.11.2025", "Faust", "Hor√°ck√© divadlo Jihlava", "Hor√°ck√© divadlo", "Jihlava", "ƒåinohra"],
        ["14.11.2025", "Potopa", "DAMU", "Divadlo DISK", "", "Studentsk√©"],
        ["18.11.2025", "Teor√©ma", "Divadlo v Dlouh√©", "Divadlo v Dlouh√©", "", "ƒåinohra"],
        ["19.11.2025", "MEIN GOTT!", "Divadlo D21", "Divadlo D21", "", "ƒåinohra"],
        ["24.11.2025", "Poprask na lagunƒõ", "Divadlo na Vinohradech", "Divadlo na Vinohradech", "", "ƒåinohra"],
        ["25.11.2025", "Nebezpeƒçn√© zn√°mosti", "Divadlo F.X. ≈†aldy", "Divadlo F.X. ≈†aldy", "Liberec", "ƒåinohra"],
        ["26.11.2025", "Plechov√Ω bub√≠nek", "Divadlo Na z√°bradl√≠", "Divadlo Na z√°bradl√≠", "", "ƒåinohra"],
        ["30.11.2025", "The Black Rider", "Mƒõstsk√° divadla pra≈æsk√°", "Divadlo Komedie", "", "Muzik√°l"],

        // PROSINEC
        ["01.12.2025", "Ema", "Pe≈°kovka", "Pe≈°kovka", "", "Muzik√°l"],
        ["04.12.2025", "27 litr≈Ø umƒõl√Ω krve", "Divadlo NoD", "Divadlo NoD", "", "Alternativa"],
        ["05.12.2025", "Kdy≈æ n√°m bylo m√≠≈à", "MeetFactory", "MeetFactory", "", "Alternativa"],
        ["06.12.2025", "Kabaret K√∂niggr√§tz", "Klicperovo divadlo", "Studio Beseda", "Hradec Kr√°lov√©", "ƒåinohra"],
        ["07.12.2025", "O poledn√°ch", "Depresivn√≠ dƒõti tou≈æ√≠ po penƒõz√≠ch", "Venu≈°e ve ≈†vehlovce", "", "Alternativa"],
        ["08.12.2025", "Zlat√© mƒõsto", "Divadlo v Dlouh√©", "Divadlo v Dlouh√©", "", "ƒåinohra"],
        ["10.12.2025", "HEROES", "Divadlo Let√≠", "Vila ≈†tvanice", "", "Alternativa"],
        ["13.12.2025", "Nana a Zabij√°k", "Mƒõstsk√° divadla pra≈æsk√°", "Divadlo ABC", "", "ƒåinohra"],
        ["14.12.2025", "Oscar pro Emily", "Studio DVA divadlo", "Mal√° sc√©na Studio DVA", "", "ƒåinohra"],
        ["16.12.2025", "Betl√©m aneb Komedie o narozen√≠", "Divadlo D21", "Divadlo D21", "", "ƒåinohra"],
        ["17.12.2025", "Mnoho povyku pro nic", "N√°rodn√≠ divadlo", "Stavovsk√© divadlo", "", "ƒåinohra"],
        ["19.12.2025", "Far√°≈ô≈Øv konec", "N√°rodn√≠ divadlo", "N√°rodn√≠ divadlo", "", "ƒåinohra"]
    ];

    const cancelledShows = [
        ["16.02.2025", "Jezinky a bezinky", "Studio DVA", "Studio DVA", "", "ƒåinohra", true],
        ["22.03.2025", "Podivuhodn√Ω p≈ô√≠pad BB", "MDP", "Rokoko", "", "Muzik√°l", true],
        ["11.06.2025", "27 litr≈Ø umƒõl√Ω krve", "NoD", "NoD", "", "Alternativa", true],
        ["08.07.2025", "Othello", "Shakespearovsk√© slavnosti", "Hrad", "", "ƒåinohra", true]
    ];

    /* --- 2. LOGIKA & ZPRACOV√ÅN√ç --- */
    
    // Konfigurace
    Chart.defaults.font.family = "'Segoe UI', sans-serif";
    Chart.defaults.color = '#a1a1aa';
    Chart.defaults.borderColor = '#27272a';
    const months = ["Leden", "√önor", "B≈ôezen", "Duben", "Kvƒõten", "ƒåerven", "ƒåervenec", "Srpen", "Z√°≈ô√≠", "≈ò√≠jen", "Listopad", "Prosinec"];
    const days = ["Ne", "Po", "√öt", "St", "ƒåt", "P√°", "So"];

    // Glob√°ln√≠ stav filtru
    let filters = { title: "", theatre: "", city: "", genre: "", month: "" };

    // Parsery
    function parseDate(str) { const p = str.split('.'); return new Date(2025, p[1]-1, p[0]); }
    function getCity(row) {
        if(row[4]) return row[4]; // Explicitnƒõ uveden√© mƒõsto
        // Detekce hostov√°n√≠ (nap≈ô. hostovaƒçka v Dlouh√© = Praha)
        if(row[3].includes("host") || row[3].includes("ARCHA") || row[3].includes("Dlouh√©") || row[3].includes("Palmovk") || row[3].includes("Rokoko")) return "Praha";
        // Default
        return "Praha";
    }

    // Inicializace dat pro grafy
    let processedData = [];
    
    function initData() {
        processedData = rawData.map(r => ({
            raw: r,
            date: parseDate(r[0]),
            title: r[1],
            theatre: r[2],
            place: r[3],
            city: getCity(r),
            genre: r[5].split('/')[0],
            monthIdx: parseDate(r[0]).getMonth(),
            dayIdx: parseDate(r[0]).getDay()
        }));
        
        populateSelects();
        updateDashboard();
    }

    function populateSelects() {
        const getUnique = (key) => [...new Set(processedData.map(d => d[key]))].sort();
        
        const theatreSel = document.getElementById('filterTheatre');
        getUnique('theatre').forEach(t => theatreSel.add(new Option(t, t)));
        
        const citySel = document.getElementById('filterCity');
        getUnique('city').forEach(c => citySel.add(new Option(c, c)));
        
        const genreSel = document.getElementById('filterGenre');
        getUnique('genre').forEach(g => genreSel.add(new Option(g, g)));
    }

    /* --- 3. RENDEROV√ÅN√ç --- */

    function updateDashboard() {
        const filtered = processedData.filter(d => {
            const mMatch = filters.month === "" || d.monthIdx == filters.month;
            const tMatch = d.title.toLowerCase().includes(filters.title.toLowerCase());
            const thMatch = filters.theatre === "" || d.theatre === filters.theatre;
            const cMatch = filters.city === "" || d.city === filters.city;
            const gMatch = filters.genre === "" || d.genre === filters.genre;
            return mMatch && tMatch && thMatch && cMatch && gMatch;
        });

        updateStats(filtered);
        renderCharts(filtered);
        renderTable(filtered);
    }

    function updateStats(data) {
        document.getElementById('statTotal').innerText = data.length;
        document.getElementById('statTheatres').innerText = new Set(data.map(d=>d.theatre)).size;
        document.getElementById('statCities').innerText = new Set(data.map(d=>d.city)).size;
        
        // Repr√≠zy logika
        const counts = {};
        data.forEach(d => counts[d.title] = (counts[d.title]||0)+1);
        let repeats = 0;
        Object.values(counts).forEach(c => { if(c>1) repeats += (c-1); });
        document.getElementById('statRepeats').innerText = repeats;
    }

    // Instance graf≈Ø
    let charts = {};

    function renderCharts(data) {
        // Agregace
        const countBy = (keyFn) => {
            const acc = {};
            data.forEach(d => { const k = keyFn(d); acc[k] = (acc[k]||0)+1; });
            return acc;
        };

        // 1. Mƒõs√≠ƒçn√≠
        const monthly = new Array(12).fill(0);
        data.forEach(d => monthly[d.monthIdx]++);
        createOrUpdateChart('chartMonthly', 'line', months, monthly, '#06b6d4', {fill: true});

        // 2. Lokace (Praha Aggregated vs Cities)
        const cityRaw = countBy(d => d.city);
        // Oddƒõlit Prahu
        const prahaVal = cityRaw["Praha"] || 0;
        delete cityRaw["Praha"];
        // Sort zbytek
        const sortedCities = Object.entries(cityRaw).sort((a,b)=>b[1]-a[1]);
        const locLabels = ["Praha (V≈°e)", ...sortedCities.map(x=>x[0])];
        const locData = [prahaVal, ...sortedCities.map(x=>x[1])];
        // Dynamic colors for locations
        const locColors = ['#06b6d4', '#f59e0b', '#f43f5e', '#8b5cf6', '#10b981', '#ff8c00'];
        createOrUpdateChart('chartLocation', 'bar', locLabels, locData, locColors);

        // 3. Top Soubory
        const theatreRaw = Object.entries(countBy(d=>d.theatre)).sort((a,b)=>b[1]-a[1]).slice(0,5);
        createOrUpdateChart('chartTheatres', 'bar', theatreRaw.map(x=>x[0]), theatreRaw.map(x=>x[1]), '#f43f5e', {indexAxis: 'y'});

        // 4. ≈Ω√°nry
        const genreRaw = Object.entries(countBy(d=>d.genre)).sort((a,b)=>b[1]-a[1]);
        createOrUpdateChart('chartGenres', 'doughnut', genreRaw.map(x=>x[0]), genreRaw.map(x=>x[1]), ['#8b5cf6', '#06b6d4', '#f43f5e', '#f59e0b', '#10b981']);

        // 5. Dny (Po-Ne shift)
        const dayCounts = new Array(7).fill(0);
        data.forEach(d => dayCounts[d.dayIdx]++);
        // Shift JS (0=Ne) to (0=Po) for display
        const daysShifted = [dayCounts[1], dayCounts[2], dayCounts[3], dayCounts[4], dayCounts[5], dayCounts[6], dayCounts[0]]; 
        const dayLabels = ["Po", "√öt", "St", "ƒåt", "P√°", "So", "Ne"];
        const dayColors = dayLabels.map((d, i) => i >= 4 ? '#f43f5e' : '#1e293b'); // V√≠kend ƒçervenƒõ
        createOrUpdateChart('chartDays', 'bar', dayLabels, daysShifted, dayColors);
    }

    function createOrUpdateChart(id, type, labels, data, colors, extraOpts = {}) {
        const ctx = document.getElementById(id).getContext('2d');
        const bgColors = Array.isArray(colors) ? colors : (type === 'line' ? 'rgba(6, 182, 212, 0.2)' : colors);
        const borderCol = Array.isArray(colors) ? colors[0] : colors;

        if (charts[id]) {
            charts[id].data.labels = labels;
            charts[id].data.datasets[0].data = data;
            charts[id].data.datasets[0].backgroundColor = bgColors;
            charts[id].update();
        } else {
            charts[id] = new Chart(ctx, {
                type: type,
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Poƒçet',
                        data: data,
                        backgroundColor: bgColors,
                        borderColor: type==='line'?colors:'transparent',
                        borderWidth: 2,
                        borderRadius: 4,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: type === 'doughnut' ? {} : {
                        x: { grid: { display: false } },
                        y: { beginAtZero: true, grid: { color: '#27272a' } }
                    },
                    onClick: (e, el) => handleChartClick(el, id, labels),
                    ...extraOpts
                }
            });
        }
    }

    // Interakce graf≈Ø -> Filtry
    function handleChartClick(elements, chartId, labels) {
        if (!elements.length) return;
        const idx = elements[0].index;
        const label = labels[idx];

        if(chartId === 'chartMonthly') {
            document.getElementById('filterMonth').value = idx; 
        } else if(chartId === 'chartTheatres') {
            document.getElementById('filterTheatre').value = label;
        } else if(chartId === 'chartGenres') {
            document.getElementById('filterGenre').value = label;
        } else if(chartId === 'chartLocation') {
             // Special logic for aggregation "Praha (V≈°e)"
             if(label === "Praha (V≈°e)") document.getElementById('filterCity').value = "Praha";
             else document.getElementById('filterCity').value = label;
        }
        
        applyFilters(); // Trigger reload
    }

    function renderTable(data) {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        
        // Se≈ôadit chronologicky
        data.sort((a,b) => a.date - b.date);

        data.forEach(row => {
            const tr = document.createElement('tr');
            
            let cityBadge = row.city !== "Praha" ? `<span class="badge badge-city ms-2">${row.city}</span>` : '';
            
            tr.innerHTML = `
                <td><span class="text-white fw-bold">${row.raw[0]}</span></td>
                <td class="text-white">${row.title}</td>
                <td>${row.theatre}</td>
                <td class="small text-muted">${row.place}</td>
                <td>${cityBadge || '<span class="opacity-50">Praha</span>'}</td>
                <td><span class="badge badge-genre">${row.genre}</span></td>
            `;
            tbody.appendChild(tr);
        });

        // Pokud nejsou aktivn√≠ filtry, p≈ôidat naspod zru≈°en√° pro info
        if(filters.title==="" && filters.theatre==="" && filters.city==="" && filters.genre==="" && filters.month==="") {
            cancelledShows.forEach(row => {
                const tr = document.createElement('tr');
                tr.classList.add('cancelled-row');
                tr.innerHTML = `
                    <td>${row[0]}</td>
                    <td>${row[1]} <span class="badge bg-danger ms-1">ZRU≈†ENO</span></td>
                    <td>${row[2]}</td>
                    <td>${row[3]}</td>
                    <td></td>
                    <td>${row[5]}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        document.getElementById('visibleCount').innerText = data.length + (filters.title===""?cancelledShows.length:0);
    }

    /* --- 4. OVL√ÅD√ÅN√ç --- */

    function applyFilters() {
        filters.title = document.getElementById('filterTitle').value;
        filters.theatre = document.getElementById('filterTheatre').value;
        filters.city = document.getElementById('filterCity').value;
        filters.genre = document.getElementById('filterGenre').value;
        filters.month = document.getElementById('filterMonth').value;
        
        if(filters.title !== "") {
            document.getElementById("dataSection").scrollIntoView({ behavior: 'smooth' });
        }
        updateDashboard();
    }

    function resetFilters() {
        document.getElementById('filterTitle').value = "";
        document.getElementById('filterTheatre').value = "";
        document.getElementById('filterCity').value = "";
        document.getElementById('filterGenre').value = "";
        document.getElementById('filterMonth').value = "";
        applyFilters();
    }

    // Listeners
    ['filterTitle', 'filterTheatre', 'filterCity', 'filterGenre', 'filterMonth'].forEach(id => {
        document.getElementById(id).addEventListener('change', applyFilters);
        if (id === 'filterTitle') {
             document.getElementById(id).addEventListener('input', applyFilters);
        }
    });

    // Start
    initData();

</script>
</body>
</html>